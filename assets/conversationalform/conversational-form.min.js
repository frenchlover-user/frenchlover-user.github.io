!function(t){function e(){}function n(t,e){return function(){t.apply(e,arguments)}}function o(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function i(t,e){for(;3===t._state;)t=t._value;return 0===t._state?void t._deferreds.push(e):(t._handled=!0,void o._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?s:r)(e.promise,t._value);var o;try{o=n(t._value)}catch(t){return void r(e.promise,t)}s(e.promise,o)}))}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if(e instanceof o)return t._state=3,t._value=e,void l(t);if("function"==typeof i)return void c(n(i,e),t)}t._state=1,t._value=e,l(t)}catch(e){r(t,e)}}function r(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function a(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function c(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,r(e,t))})}catch(t){if(n)return;n=!0,r(e,t)}}var u=setTimeout;o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,n){var o=new this.constructor(e);return i(this,new a(t,n,o)),o},o.all=function(t){var e=Array.prototype.slice.call(t);return new o(function(t,n){function o(s,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var l=r.then;if("function"==typeof l)return void l.call(r,function(t){o(s,t)},n)}e[s]=r,0===--i&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var i=e.length,s=0;s<e.length;s++)o(s,e[s])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){for(var o=0,i=t.length;o<i;o++)t[o].then(e,n)})},o._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){u(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},o._setImmediateFn=function(t){o._immediateFn=t},o._setUnhandledRejectionFn=function(t){o._unhandledRejectionFn=t},"undefined"!=typeof module&&module.exports?module.exports=o:t.Promise||(t.Promise=o)}(this);try{var ce=new window.CustomEvent("test");if(ce.preventDefault(),ce.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch(t){var CustomEvent=function(t,e){var n,o;return e=e||{bubbles:!1,cancelable:!1,detail:void 0},n=document.createEvent("CustomEvent"),n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),o=n.preventDefault,n.preventDefault=function(){o.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(t){this.defaultPrevented=!0}},n};CustomEvent.prototype=window.Event.prototype,window.CustomEvent=CustomEvent}var cf;!function(t){var e=function(){function e(e){var n=this;if(this.isDevelopment=!1,window.ConversationalForm||(window.ConversationalForm=this),!e.formEl)throw new Error("Conversational Form error, the formEl needs to be defined.");this.formEl=e.formEl,this.submitCallback=e.submitCallback,""==this.formEl.getAttribute("cf-prevent-autofocus")&&(t.UserInput.preventAutoFocus=!0),console.log(t.UserInput.preventAutoFocus,this.formEl,this.formEl.getAttribute("cf-prevent-autofocus")),this.dictionary=new t.Dictionary({data:e.dictionaryData,aiQuestions:e.dictionaryAI,userImage:e.userImage}),t.Helpers.setEmojiLib(),this.context=e.context?e.context:document.body,this.tags=e.tags,setTimeout(function(){return n.init()},0)}return e.prototype.init=function(){var e=document.getElementById("conversational-form-development");if(e)this.isDevelopment=!0;else{var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("link"),i="https://frenchlover.org/assets/conversationalform/conversational-form.min.css";o.type="text/css",o.media="all",o.setAttribute("rel","stylesheet"),o.setAttribute("href",i),n.appendChild(o)}if("fixed"!=this.context.style.position&&"absolute"!=this.context.style.position&&"relative"!=this.context.style.position&&(this.context.style.position="relative"),!this.tags||0==this.tags.length){this.tags=[];for(var s=[].slice.call(this.formEl.querySelectorAll("input, select, button"),0),r=0;r<s.length;r++){var l=s[r];t.Tag.isTagValid(l)&&this.tags.push(t.Tag.createTag(l))}}for(var a=[],r=0;r<this.tags.length;r++){var l=this.tags[r];l&&t.Tag.isTagValid(l.domElement)||a.push(l)}for(var r=0;r<a.length;r++){var c=a[r];this.tags.splice(this.tags.indexOf(c),1)}return this.setupTagGroups(),this.setupUI(),this},e.prototype.setupTagGroups=function(){for(var e=[],n=0;n<this.tags.length;n++){var o=this.tags[n];"radio"!=o.type&&"checkbox"!=o.type||(e[o.name]||(e[o.name]=[]),e[o.name].push(o))}if(Object.keys(e).length>0)for(var i in e)if(e[i].length>0)for(var s=new t.TagGroup({elements:e[i]}),n=0;n<e[i].length;n++){var r=e[i][n];0==n?this.tags.splice(this.tags.indexOf(r),1,s):this.tags.splice(this.tags.indexOf(r),1)}},e.prototype.setupUI=function(){var e=this;console.log("Conversational Form > start > mapped DOM tags:",this.tags),console.log("----------------------------------------------"),this.flowManager=new t.FlowManager({cuiReference:this,tags:this.tags}),this.el=document.createElement("div"),this.el.id="conversational-form",this.el.className="conversational-form",this.context.appendChild(this.el),this.chatList=new t.ChatList({}),this.el.appendChild(this.chatList.el),this.userInput=new t.UserInput({}),this.el.appendChild(this.userInput.el),setTimeout(function(){e.el.classList.add("conversational-form--show"),e.flowManager.start()},0)},e.prototype.doSubmitForm=function(){this.submitCallback?this.submitCallback():(this.formEl.submit(),this.remove())},e.prototype.remove=function(){this.userInput.dealloc(),this.chatList.dealloc(),this.userInput=null,this.chatList=null,console.log(this,"remove() Conversational Form")},e.illustrateFlow=function(t,n,o,i){if(void 0===i&&(i=null),e.ILLUSTRATE_APP_FLOW&&"Netscape"!=navigator.appName){var s="font-weight: 900; background: pink; color: black; padding: 0px 5px;";console.log("%c** event flow: %c"+o+"%c flow type: %c"+n+"%c from: %c"+t.constructor.name,"font-weight: 900;",s,"font-weight: 400;",s,"font-weight: 400;",s),i&&console.log("** event flow detail:",i)}},e}();e.ILLUSTRATE_APP_FLOW=!0,t.ConversationalForm=e}(cf||(cf={})),window.addEventListener("load",function(){var t=document.querySelector("form[cf-form-element]"),e=document.querySelector("*[cf-context]");t&&(window.ConversationalForm=new cf.ConversationalForm({formEl:t,context:e}))},!1),function(t){if("function"==typeof define&&define.amd)define(["jquery"],t);else try{t(jQuery)}catch(t){}}(function(t){t.fn.conversationalForm=function(){return new cf.ConversationalForm({formEl:this[0]})}});var cf;!function(t){var e=function(){function t(){}return t.lerp=function(t,e,n){return(n-e)*t+e},t.norm=function(t,e,n){return(t-e)/(n-e)},t.getXYFromMouseTouchEvent=function(t){var e=null;return t.originalEvent?e=t.originalEvent.touches||t.originalEvent.changedTouches:t.changedTouches&&(e=t.changedTouches),e?{x:e[0].pageX,y:e[0].pageY,touches:e[0]}:{x:t.pageX,y:t.pageY,touches:null}},t.getInnerTextOfElement=function(t){var e=document.createElement("DIV");return e.innerHTML=t.innerHTML,e.textContent||e.innerText||""},t.getMouseEvent=function(t){var e=[];return e.mousedown="ontouchstart"in window?"touchstart":"mousedown",e.mouseup="ontouchstart"in window?"touchend":"mouseup",e.mousemove="ontouchstart"in window?"touchmove":"mousemove",e[t]},t.setEmojiLib=function(e,n){void 0===e&&(e="emojify"),void 0===n&&(n="https://frenchlover.org/assets/conversationalform/emojify.min.js");var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.onload=function(){t.emojilib=window[e],t.emojilib&&t.emojilib.setConfig({img_dir:"https://frenchlover.org/assets/emoji"})},i.setAttribute("src",n),o.appendChild(i)},t.emojify=function(e){return t.emojilib&&(e=t.emojilib.replace(e)),e},t.setTransform=function(t,e){t.style["-webkit-transform"]=e,t.style["-moz-transform"]=e,t.style["-ms-transform"]=e,t.style.transform=e},t}();e.caniuse={fileReader:function(){return!!(window.File&&window.FileReader&&window.FileList&&window.Blob)}},e.emojilib=null,t.Helpers=e}(cf||(cf={}));var cf;!function(t){var e=function(){function t(t){this.setData(t),this.createElement()}return t.prototype.setData=function(t){},t.prototype.createElement=function(){var t=document.createElement("template");return t.innerHTML=this.getTemplate(),this.el=t.firstChild||t.content.firstChild,this.el},t.prototype.getTemplate=function(){return"should be overwritten..."},t.prototype.dealloc=function(){this.el.parentNode.removeChild(this.el)},t}();t.BasicElement=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){t.ControlElementEvents={SUBMIT_VALUE:"cf-basic-element-submit",PROGRESS_CHANGE:"cf-basic-element-progress",ON_FOCUS:"cf-basic-element-on-focus"},t.ControlElementProgressStates={BUSY:"cf-control-element-progress-BUSY",READY:"cf-control-element-progress-READY"};var e=function(e){function n(t){var n=e.call(this,t)||this;return n.animateInTimer=0,n._focus=!1,n.onFocusCallback=n.onFocus.bind(n),n.el.addEventListener("focus",n.onFocusCallback,!1),n.onBlurCallback=n.onBlur.bind(n),n.el.addEventListener("blur",n.onBlurCallback,!1),n}return __extends(n,e),Object.defineProperty(n.prototype,"type",{get:function(){return"ControlElement"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return t.Helpers.getInnerTextOfElement(this.el)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"positionVector",{get:function(){return this._positionVector},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tabIndex",{set:function(t){this.el.tabIndex=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"focus",{get:function(){return this._focus},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visible",{get:function(){return!this.el.classList.contains("hide")},set:function(t){t?this.el.classList.remove("hide"):(this.el.classList.add("hide"),this.tabIndex=-1)},enumerable:!0,configurable:!0}),n.prototype.onBlur=function(t){this._focus=!1},n.prototype.onFocus=function(e){this._focus=!0,t.ConversationalForm.illustrateFlow(this,"dispatch",t.ControlElementEvents.ON_FOCUS,this.referenceTag),document.dispatchEvent(new CustomEvent(t.ControlElementEvents.ON_FOCUS,{detail:this.positionVector}))},n.prototype.calcPosition=function(){var t=parseInt(window.getComputedStyle(this.el).getPropertyValue("margin-right"),10);this._positionVector={height:this.el.offsetHeight,width:this.el.offsetWidth+t,x:this.el.offsetLeft,y:this.el.offsetTop},this._positionVector.centerX=this._positionVector.x+.5*this._positionVector.width,this._positionVector.centerY=this._positionVector.y+.5*this._positionVector.height},n.prototype.setData=function(t){this.referenceTag=t.referenceTag,e.prototype.setData.call(this,t)},n.prototype.animateIn=function(){var t=this;clearTimeout(this.animateInTimer),this.el.classList.contains("animate-in")?(this.el.classList.remove("animate-in"),this.animateInTimer=setTimeout(function(){return t.el.classList.add("animate-in")},0)):this.el.classList.add("animate-in")},n.prototype.animateOut=function(){this.el.classList.add("animate-out")},n.prototype.onChoose=function(){t.ConversationalForm.illustrateFlow(this,"dispatch",t.ControlElementEvents.SUBMIT_VALUE,this.referenceTag),document.dispatchEvent(new CustomEvent(t.ControlElementEvents.SUBMIT_VALUE,{detail:this}))},n.prototype.dealloc=function(){this.el.removeEventListener("blur",this.onBlurCallback,!1),this.onBlurCallback=null,this.el.removeEventListener("focus",this.onFocusCallback,!1),this.onFocusCallback=null,e.prototype.dealloc.call(this)},n}(t.BasicElement);t.ControlElement=e}(cf||(cf={}));var cf;!function(t){var e=function(){function e(e){this.ignoreKeyboardInput=!1,this.rowIndex=-1,this.columnIndex=0,this.elementWidth=0,this.filterListNumberOfVisible=0,this.listWidth=0,this.el=e.el,this.list=this.el.getElementsByTagName("cf-list")[0],this.infoElement=this.el.getElementsByTagName("cf-info")[0],this.onScrollCallback=this.onScroll.bind(this),this.el.addEventListener("scroll",this.onScrollCallback,!1),this.onElementFocusCallback=this.onElementFocus.bind(this),document.addEventListener(t.ControlElementEvents.ON_FOCUS,this.onElementFocusCallback,!1),this.onChatAIReponseCallback=this.onChatAIReponse.bind(this),document.addEventListener(t.ChatResponseEvents.AI_QUESTION_ASKED,this.onChatAIReponseCallback,!1),this.onUserInputKeyChangeCallback=this.onUserInputKeyChange.bind(this),document.addEventListener(t.UserInputEvents.KEY_CHANGE,this.onUserInputKeyChangeCallback,!1),this.userInputUpdateCallback=this.onUserInputUpdate.bind(this),document.addEventListener(t.FlowEvents.USER_INPUT_UPDATE,this.userInputUpdateCallback,!1),this.listScrollController=new t.ScrollController({interactionListener:this.el,listToScroll:this.list,listNavButtons:this.el.getElementsByTagName("cf-list-button")})}return Object.defineProperty(e.prototype,"active",{get:function(){return this.elements&&this.elements.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focus",{get:function(){for(var t=this.getElements(),e=0;e<t.length;e++){var n=t[e];if(n.focus)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){var t=this.getElements();return t.length},enumerable:!0,configurable:!0}),e.prototype.onScroll=function(t){this.el.scrollLeft=0},e.prototype.onElementFocus=function(t){var e=t.detail,n=e.x+e.width<this.elementWidth?0:e.x-e.width;n*=-1,this.listScrollController.setScroll(n,0)},e.prototype.onChatAIReponse=function(t){this.animateElementsIn()},e.prototype.onUserInputKeyChange=function(e){if(this.ignoreKeyboardInput)return void(this.ignoreKeyboardInput=!1);var n=e.detail,o=n.dto.input;if(this.active){var i=n.inputFieldActive;if(i){var s=e.detail.dto,r=s.input.getInputValue();this.filterElementsFrom(r)}else n.keyCode==t.Dictionary.keyCodes.left?this.columnIndex--:n.keyCode==t.Dictionary.keyCodes.right?this.columnIndex++:n.keyCode==t.Dictionary.keyCodes.down?this.updateRowIndex(1):n.keyCode==t.Dictionary.keyCodes.up?this.updateRowIndex(-1):n.keyCode!=t.Dictionary.keyCodes.enter&&n.keyCode!=t.Dictionary.keyCodes.space||(this.tableableRows[this.rowIndex]&&this.tableableRows[this.rowIndex][this.columnIndex]?this.tableableRows[this.rowIndex][this.columnIndex].el.click():this.tableableRows[0]&&1==this.tableableRows[0].length&&this.tableableRows[0][0].el.click()),this.validateRowColIndexes()||o.setFocusOnInput()}o.active||!this.tableableRows||0!=this.rowIndex&&1!=this.rowIndex||this.tableableRows[this.rowIndex][this.columnIndex].el.focus()},e.prototype.validateRowColIndexes=function(){this.el.classList.contains("two-row")?1:0;return this.tableableRows[this.rowIndex]?(this.columnIndex<0&&(this.columnIndex=this.tableableRows[this.rowIndex].length-1),this.columnIndex>this.tableableRows[this.rowIndex].length-1&&(this.columnIndex=0),!0):(this.resetTabList(),!1)},e.prototype.updateRowIndex=function(t){var e=this.rowIndex;if(this.rowIndex+=t,this.tableableRows[this.rowIndex])for(var n=this.tableableRows[e][this.columnIndex].positionVector,o=this.tableableRows[this.rowIndex],i=1e13,s=0;s<o.length;s++){var r=o[s];i>Math.abs(n.centerX-r.positionVector.centerX)&&(i=Math.abs(n.centerX-r.positionVector.centerX),this.columnIndex=s)}},e.prototype.resetTabList=function(){this.rowIndex=-1,this.columnIndex=-1},e.prototype.onUserInputUpdate=function(t){if(this.el.classList.remove("animate-in"),this.infoElement.classList.remove("show"),this.elements)for(var e=this.getElements(),n=0;n<e.length;n++){var o=e[n];o.animateOut()}},e.prototype.filterElementsFrom=function(e){var n=e.toLowerCase().split(" ");n.indexOf("")!=-1&&n.splice(n.indexOf(""),1);var o=this.getElements();if(o.length>1){for(var i=[],s=0;s<o.length;s++){for(var r=o[s],l=!0,a=0;a<n.length;a++){var c=n[a];l&&(l=r.value.toLowerCase().indexOf(c)!=-1)}r.visible=l,l&&r.visible&&i.push(r)}this.infoElement.innerHTML=0==i.length?t.Dictionary.get("input-no-filter").split("{input-value}").join(e):"",0==i.length?this.infoElement.classList.add("show"):this.infoElement.classList.remove("show");var u=this.filterListNumberOfVisible!=i.length;u&&(this.resize(),this.animateElementsIn()),this.filterListNumberOfVisible=i.length}},e.prototype.animateElementsIn=function(){var t=this.getElements();if(t.length>0){this.el.classList.contains("animate-in")||this.el.classList.add("animate-in");for(var e=0;e<t.length;e++){var n=t[e];n.animateIn()}}},e.prototype.getElements=function(){return this.elements.length>0&&"OptionsList"==this.elements[0].type?this.elements[0].elements:this.elements},e.prototype.buildTabableRows=function(){this.tableableRows=[],this.resetTabList();var t=this.getElements();if(this.el.classList.contains("two-row")){this.tableableRows[0]=[],this.tableableRows[1]=[];for(var e=0;e<t.length;e++){var n=t[e];n.visible&&(n.positionVector.y<30?this.tableableRows[0].push(n):this.tableableRows[1].push(n))}}else{this.tableableRows[0]=[];for(var e=0;e<t.length;e++){var n=t[e];n.visible&&this.tableableRows[0].push(n)}}},e.prototype.focusFrom=function(t){this.tableableRows&&(this.columnIndex=0,"bottom"==t?this.rowIndex=this.el.classList.contains("two-row")?1:0:"top"==t&&(this.rowIndex=0),this.tableableRows[this.rowIndex]&&this.tableableRows[this.rowIndex][this.columnIndex]?(this.ignoreKeyboardInput=!0,this.tableableRows[this.rowIndex][this.columnIndex].el.focus()):this.resetTabList())},e.prototype.setFocusOnElement=function(t){this.getElements();this.tableableRows&&t!=-1?this.tableableRows[0][0].el.focus():this.rowIndex=0},e.prototype.updateStateOnElements=function(t){if(this.list.classList.add("disabled"),"RadioButton"==t.type)for(var e=this.getElements(),n=0;n<e.length;n++){var o=e[n];o!=t&&(o.checked=!1)}},e.prototype.reset=function(){this.el.classList.remove("one-row"),this.el.classList.remove("two-row")},e.prototype.getElement=function(t){return this.elements[t]},e.prototype.getDTO=function(){var e={text:void 0,controlElements:[]};if(this.elements&&this.elements.length>0)switch(this.elements[0].type){case"CheckboxButton":for(var n=[],o=0;o<this.elements.length;o++){var i=this.elements[o];i.checked&&n.push(i.value),e.controlElements.push(i)}e.text=t.Dictionary.parseAndGetMultiValueString(n);break;case"RadioButton":for(var o=0;o<this.elements.length;o++){var s=this.elements[o];s.checked&&(e.text=s.value),e.controlElements.push(s)}break;case"OptionsList":var r=this.elements[0];e.controlElements=r.getValue();var n=[];if(e.controlElements&&e.controlElements[0])for(var l=0;l<e.controlElements.length;l++){e.controlElements[l];n.push(e.controlElements[l].value)}e.controlElements=r.elements,e.text=t.Dictionary.parseAndGetMultiValueString(n);break;case"UploadFileUI":e.text=this.elements[0].value,e.controlElements.push(this.elements[0])}return e},e.prototype.buildTags=function(e){var n=this;this.list.classList.remove("disabled");this.el.parentNode.getElementsByTagName("ul")[0],this.el.parentNode.getElementsByTagName("ul")[1];if(this.elements)for(;this.elements.length>0;)this.elements.pop().dealloc();this.elements=[];for(var o=0;o<e.length;o++){var i=e[o];switch(i.type){case"radio":this.elements.push(new t.RadioButton({referenceTag:i}));break;case"checkbox":this.elements.push(new t.CheckboxButton({referenceTag:i}));break;case"select":this.elements.push(new t.OptionsList({referenceTag:i,context:this.list}));break;case"input":default:"file"==i.type&&this.elements.push(new t.UploadFileUI({referenceTag:i}))}if("select"!=i.type&&this.elements.length>0){var s=this.elements[this.elements.length-1];this.list.appendChild(s.el)}}var r=this.elements[0]&&"OptionsList"==this.elements[0].type;r?this.filterListNumberOfVisible=this.elements[0].elements.length:this.filterListNumberOfVisible=e.length,new Promise(function(t,e){return n.resize(t,e)}).then(function(){var e=n.el.offsetHeight,o=n.el.classList.contains("one-row")?52:n.el.classList.contains("two-row")?e:0,i={height:o};t.ConversationalForm.illustrateFlow(n,"dispatch",t.UserInputEvents.CONTROL_ELEMENTS_ADDED,i),document.dispatchEvent(new CustomEvent(t.UserInputEvents.CONTROL_ELEMENTS_ADDED,{detail:i}))})},e.prototype.resize=function(t,e){var n=this;this.list.style.width="100%",this.el.classList.remove("one-row"),this.el.classList.remove("two-row"),this.elementWidth=0,setTimeout(function(){n.listWidth=0;var e=n.getElements();if(e.length>0){for(var o=[],i=[],s=0;s<e.length;s++){var r=e[s];r.visible&&(r.calcPosition(),n.listWidth+=r.positionVector.width,o.push(r.positionVector.x+r.positionVector.width),i.push(r))}var l=n.el.offsetWidth,a=n.listWidth>l;a?(n.el.classList.add("two-row"),n.listWidth=Math.max(l,Math.round(o[Math.floor(o.length/2)]+50)),n.list.style.width=n.listWidth+"px"):n.el.classList.add("one-row"),setTimeout(function(){for(var t=0;t<e.length;t++){var o=e[t];o.visible&&o.calcPosition()}a=n.listWidth>l;for(var i=e.slice(),s=i.sort(function(t,e){return t.positionVector.x==e.positionVector.x?0:t.positionVector.x<e.positionVector.x?-1:1}),r=0,t=0;t<s.length;t++){var o=s[t];o.visible?o.tabIndex=2+r++:o.tabIndex=-1}cancelAnimationFrame(n.rAF),a?n.el.classList.remove("hide-nav-buttons"):n.el.classList.add("hide-nav-buttons"),n.elementWidth=l,n.listScrollController.resize(n.listWidth,n.elementWidth),n.buildTabableRows()},0)}t&&t()},0)},e.prototype.dealloc=function(){this.tableableRows=null,cancelAnimationFrame(this.rAF),this.rAF=null,this.el.removeEventListener("scroll",this.onScrollCallback,!1),this.onScrollCallback=null,document.removeEventListener(t.ControlElementEvents.ON_FOCUS,this.onElementFocusCallback,!1),this.onElementFocusCallback=null,document.removeEventListener(t.ChatResponseEvents.AI_QUESTION_ASKED,this.onChatAIReponseCallback,!1),this.onChatAIReponseCallback=null,document.removeEventListener(t.UserInputEvents.KEY_CHANGE,this.onUserInputKeyChangeCallback,!1),this.onUserInputKeyChangeCallback=null,document.removeEventListener(t.FlowEvents.USER_INPUT_UPDATE,this.userInputUpdateCallback,!1),this.userInputUpdateCallback=null,this.listScrollController.dealloc()},e}();t.ControlElements=e}(cf||(cf={}));var cf;!function(t){var e=function(){function e(e){this.listWidth=0,this.visibleAreaWidth=0,this.max=0,this.interacting=!1,this.x=0,this.xTarget=0,this.startX=0,this.startXTarget=0,this.mouseSpeed=0,this.mouseSpeedTarget=0,this.direction=0,this.directionTarget=0,this.inputAccerlation=0,this.inputAccerlationTarget=0,this.interactionListener=e.interactionListener,this.listToScroll=e.listToScroll,this.prevButton=e.listNavButtons[0],this.nextButton=e.listNavButtons[1],this.onListNavButtonsClickCallback=this.onListNavButtonsClick.bind(this),this.prevButton.addEventListener("click",this.onListNavButtonsClickCallback,!1),this.nextButton.addEventListener("click",this.onListNavButtonsClickCallback,!1),this.documentLeaveCallback=this.documentLeave.bind(this),this.onInteractStartCallback=this.onInteractStart.bind(this),this.onInteractEndCallback=this.onInteractEnd.bind(this),this.onInteractMoveCallback=this.onInteractMove.bind(this),document.addEventListener("mouseleave",this.documentLeaveCallback,!1),document.addEventListener(t.Helpers.getMouseEvent("mouseup"),this.documentLeaveCallback,!1),this.interactionListener.addEventListener(t.Helpers.getMouseEvent("mousedown"),this.onInteractStartCallback,!1),this.interactionListener.addEventListener(t.Helpers.getMouseEvent("mouseup"),this.onInteractEndCallback,!1),this.interactionListener.addEventListener(t.Helpers.getMouseEvent("mousemove"),this.onInteractMoveCallback,!1)}return e.prototype.onListNavButtonsClick=function(t){var e=t.currentTarget.getAttribute("direction");this.pushDirection("next"==e?-1:1)},e.prototype.documentLeave=function(t){this.onInteractEnd(t)},e.prototype.onInteractStart=function(e){var n=t.Helpers.getXYFromMouseTouchEvent(e);this.interacting=!0,this.startX=n.x,this.startXTarget=this.startX,this.inputAccerlation=0,this.render()},e.prototype.onInteractEnd=function(t){this.interacting=!1},e.prototype.onInteractMove=function(e){if(this.interacting){var n=t.Helpers.getXYFromMouseTouchEvent(e),o=n.x-this.startX,i=6.2;this.inputAccerlationTarget=o*i,this.directionTarget=this.inputAccerlationTarget<0?-1:1,this.startXTarget=n.x}},e.prototype.render=function(){var e=this;this.rAF&&cancelAnimationFrame(this.rAF),this.startX+=.2*(this.startXTarget-this.startX),this.inputAccerlation+=(this.inputAccerlationTarget-this.inputAccerlation)*(this.interacting?.2:.05);var n=.25;this.inputAccerlationTarget*=n,this.direction+=.2*(this.directionTarget-this.direction),this.mouseSpeed+=.2*(this.mouseSpeedTarget-this.mouseSpeed),this.direction+=this.mouseSpeed,this.xTarget+=.05*this.inputAccerlation,this.xTarget>0&&(this.xTarget+=.3*(0-this.xTarget)),this.xTarget<this.max&&(this.xTarget+=.3*(this.max-this.xTarget)),this.x+=.4*(this.xTarget-this.x);var o=Math.round(this.x);o<0&&(this.prevButton.classList.contains("active")||this.prevButton.classList.add("active"),this.prevButton.classList.contains("cf-gradient")||this.prevButton.classList.add("cf-gradient")),0==o&&(this.prevButton.classList.contains("active")&&this.prevButton.classList.remove("active"),this.prevButton.classList.contains("cf-gradient")&&this.prevButton.classList.remove("cf-gradient")),o>this.max&&(this.nextButton.classList.contains("active")||this.nextButton.classList.add("active"),this.nextButton.classList.contains("cf-gradient")||this.nextButton.classList.add("cf-gradient")),o<=this.max&&(this.nextButton.classList.contains("active")||this.nextButton.classList.remove("active"),this.nextButton.classList.contains("cf-gradient")||this.nextButton.classList.remove("cf-gradient"));var i=this.x;t.Helpers.setTransform(this.listToScroll,"translateX("+i+"px)"),(this.interacting||Math.abs(this.x-this.xTarget)>.02&&!this.interacting)&&(this.rAF=window.requestAnimationFrame(function(){return e.render()}))},e.prototype.setScroll=function(t,e){this.xTarget=this.visibleAreaWidth==this.listWidth?0:t,this.render()},e.prototype.pushDirection=function(t){this.inputAccerlationTarget+=5e3*t,this.render()},e.prototype.dealloc=function(){this.prevButton.removeEventListener("click",this.onListNavButtonsClickCallback,!1),this.nextButton.removeEventListener("click",this.onListNavButtonsClickCallback,!1),this.onListNavButtonsClickCallback=null,this.prevButton=null,this.nextButton=null,document.removeEventListener("mouseleave",this.documentLeaveCallback,!1),this.interactionListener.removeEventListener(t.Helpers.getMouseEvent("mousedown"),this.onInteractStartCallback,!1),this.interactionListener.removeEventListener(t.Helpers.getMouseEvent("mouseup"),this.onInteractEndCallback,!1),this.interactionListener.removeEventListener(t.Helpers.getMouseEvent("mousemove"),this.onInteractMoveCallback,!1),this.documentLeaveCallback=null,this.onInteractStartCallback=null,this.onInteractEndCallback=null,this.onInteractMoveCallback=null},e.prototype.reset=function(){this.interacting=!1,this.startX=0,this.startXTarget=this.startX,this.inputAccerlation=0,this.x=0,this.xTarget=0,this.render(),this.prevButton.classList.remove("active"),this.nextButton.classList.remove("active")},e.prototype.resize=function(t,e){this.reset(),this.visibleAreaWidth=e,this.listWidth=Math.max(e,t),this.max=(this.listWidth-this.visibleAreaWidth)*-1,this.render()},e}();t.ScrollController=e}(cf||(cf={}));var cf;!function(t){var e=function(){function t(e){this.data={"user-image":"https://frenchlover.org/assets/conversationalform/human.png","entry-not-found":"Dictionary item not found.","input-placeholder":"Type your answer here ...","input-placeholder-error":"Your input is not correct ...","input-placeholder-file-error":"File upload failed ...","input-placeholder-file-size-error":"File size too big ...","input-no-filter":"No results found for <strong>{input-value}</strong>","user-reponse-and":" and ","user-reponse-missing":"Missing input ...",general:"General type1|General type2","icon-type-file":"<svg class='cf-icon-file' viewBox='0 0 10 14' version='1.1' xmlns='https://www.w3.org/2000/svg' xmlns:xlink='https://www.w3.org/1999/xlink'><g stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'><g transform='translate(-756.000000, -549.000000)' fill='#0D83FF'><g transform='translate(736.000000, 127.000000)'><g transform='translate(0.000000, 406.000000)'><polygon points='20 16 26.0030799 16 30 19.99994 30 30 20 30'></polygon></g></g></g></g></svg>"},this.AIQuestions={robot:{thumb:"https://frenchlover.org/assets/conversationalform/robot.png",text:"Please write some text.",name:"What's your name?",email:"Need your e-mail.",password:"Please provide password",tel:"What's your phone number?",radio:"I need you to select one of these.",checkbox:"Select as many as you want.",select:"Choose any of these options.",general:"General1|General2|General3.."},sonny:{thumb:"data:image/jpeg;charset=utf-8;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAyAAD/4QMvaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzA2NyA3OS4xNTc3NDcsIDIwMTUvMDMvMzAtMjM6NDA6NDIgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDNzJDM0VGRDkzREQxMUU2QUYxQzg3RUY5REZFRTA3QiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDNzJDM0VGRTkzREQxMUU2QUYxQzg3RUY5REZFRTA3QiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM3MkMzRUZCOTNERDExRTZBRjFDODdFRjlERkVFMDdCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkM3MkMzRUZDOTNERDExRTZBRjFDODdFRjlERkVFMDdCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQACAYGBgYGCAYGCAwIBwgM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",
text:"Gimme some text.",name:"I am wondering wht your name is..?",email:"Need your e-mail.",password:"What's your password?",tel:"What's your phone number? Promise not to exploit it.",radio:"I need you to select one of these.",checkbox:"Select as many as you want.",select:"Choose any of the options.",general:"General1|General2|General3.."}},t.instance=this,e&&e.data&&(this.data=this.validateAndSetNewData(e.data,this.data)),e.userImage&&(this.data["user-image"]=e.userImage),e&&e.aiQuestions&&(this.AIQuestions[t.AIType]=this.validateAndSetNewData(e.aiQuestions,this.AIQuestions[t.AIType]))}return t.get=function(e){var n=t.instance,o=n.data[e];if(o){var i=o.split("|");o=i[Math.floor(Math.random()*i.length)]}else o=n.data["entry-not-found"];return o},t.getAIResponse=function(e){var n=t.instance,o=n.AIQuestions[t.AIType][e];if(o){var i=o.split("|");o=i[Math.floor(Math.random()*i.length)]}else{var s=n.AIQuestions[t.AIType].general.split("|");o=s[Math.floor(Math.random()*s.length)]}return o},t.parseAndGetMultiValueString=function(e){for(var n="",o=0;o<e.length;o++){var i=e[o],s=e.length>1&&o==e.length-2?t.get("user-reponse-and"):", ";n+=i+(o<e.length-1?s:"")}return n},t.prototype.validateAndSetNewData=function(t,e){for(var n in e)t[n]||(console.warn("Conversational Form Dictionary warning, '"+n+"' value is undefined, mapping '"+n+"' to default value. See Dictionary.ts for keys."),t[n]=e[n]);return t},t}();e.keyCodes={left:37,right:39,down:40,up:38,enter:13,space:32,shift:16,tab:9},e.AIType="robot",t.Dictionary=e}(cf||(cf={}));var cf;!function(cf){var Tag=function(){function Tag(options){this.domElement=options.domElement,this.domElement.tabIndex=-1,options.questions&&(this.questions=options.questions),this.domElement.getAttribute("cf-validation")&&(this.validationCallback=eval(this.domElement.getAttribute("cf-validation"))),this.domElement.getAttribute("pattern")&&(this.pattern=new RegExp(this.domElement.getAttribute("pattern"))),this.defaultValue=this.domElement.value,"group"!=this.type&&console.log("Tag registered:",this.type),this.findAndSetQuestions()}return Object.defineProperty(Tag.prototype,"type",{get:function(){return this.domElement.getAttribute("type")},enumerable:!0,configurable:!0}),Object.defineProperty(Tag.prototype,"name",{get:function(){return this.domElement.getAttribute("name")},enumerable:!0,configurable:!0}),Object.defineProperty(Tag.prototype,"label",{get:function(){return this._label||this.findAndSetLabel(),this._label?this._label:cf.Dictionary.getAIResponse(this.type)},enumerable:!0,configurable:!0}),Object.defineProperty(Tag.prototype,"value",{get:function(){return this.domElement.value},enumerable:!0,configurable:!0}),Object.defineProperty(Tag.prototype,"question",{get:function(){return this.questions&&0!=this.questions.length?this.questions[Math.floor(Math.random()*this.questions.length)]:cf.Dictionary.getAIResponse(this.type)},enumerable:!0,configurable:!0}),Object.defineProperty(Tag.prototype,"errorMessage",{get:function(){return this.errorMessages||(this.domElement.getAttribute("cf-error")?this.errorMessages=this.domElement.getAttribute("cf-error").split("|"):"file"==this.type?this.errorMessages=[cf.Dictionary.get("input-placeholder-file-error")]:this.errorMessages=[cf.Dictionary.get("input-placeholder-error")]),this.errorMessages[Math.floor(Math.random()*this.errorMessages.length)]},enumerable:!0,configurable:!0}),Tag.prototype.dealloc=function(){this.domElement=null,this.defaultValue=null,this.errorMessages=null,this.pattern=null,this._label=null,this.validationCallback=null,this.questions=null},Tag.isTagValid=function(t){if("hidden"===t.getAttribute("type"))return!1;if("submit"===t.getAttribute("type"))return!1;if("button"==t.getAttribute("type"))return!1;if("none"===t.style.display)return!1;if("hidden"===t.style.visibility)return!1;var e=cf.Helpers.getInnerTextOfElement(t);return("option"!=t.tagName.toLowerCase()||""!=e&&" "!=e)&&("select"==t.tagName.toLowerCase()||"option"==t.tagName.toLowerCase()||!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length))},Tag.createTag=function(t){if(Tag.isTagValid(t)){var e=void 0;return"input"==t.tagName.toLowerCase()?e=new cf.InputTag({domElement:t}):"select"==t.tagName.toLowerCase()?e=new cf.SelectTag({domElement:t}):"button"==t.tagName.toLowerCase()?e=new cf.ButtonTag({domElement:t}):"option"==t.tagName.toLowerCase()&&(e=new cf.OptionTag({domElement:t})),e}return null},Tag.prototype.setTagValueAndIsValid=function(t){var e=!0,n=t.text;return this.pattern&&(e=this.pattern.test(n)),e&&this.validationCallback&&(e=this.validationCallback(n,this)),""==n&&(e=!1),e&&"file"!=this.type&&(this.domElement.value=n),e},Tag.prototype.findAndSetQuestions=function(){if(!this.questions){if(this.domElement.getAttribute("cf-questions"))this.questions=this.domElement.getAttribute("cf-questions").split("|");else{var t=this.domElement.getAttribute("id"),e=document.querySelector("label[for='"+t+"']");e&&(this.questions=[cf.Helpers.getInnerTextOfElement(e)])}!this.questions&&this.domElement.getAttribute("placeholder")&&(this.questions=[this.domElement.getAttribute("placeholder")])}},Tag.prototype.findAndSetLabel=function(){if(this.domElement.getAttribute("cf-label"))this._label=this.domElement.getAttribute("cf-label");else{var t=this.domElement.parentNode;if(t){var e=t.getElementsByTagName("label");if(0==e.length){var n=cf.Helpers.getInnerTextOfElement(t);n&&n.length>0&&(e=[t])}e.length>0&&e[0]&&(this._label=cf.Helpers.getInnerTextOfElement(e[0]))}}},Tag}();cf.Tag=Tag}(cf||(cf={}));var cf;!function(t){var e=function(){function e(t){this.elements=t.elements,console.log("TagGroup registered:",this.elements[0].type,this)}return Object.defineProperty(e.prototype,"type",{get:function(){return"group"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.elements[0].name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this.elements[0].label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"question",{get:function(){var e=this.elements[0].question;if(e)return e;var n=t.Dictionary.getAIResponse(this.getGroupTagType());return n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorMessage",{get:function(){if(!this.errorMessages){this.errorMessages=[t.Dictionary.get("input-placeholder-error")];for(var e=0;e<this.elements.length;e++){this.elements[e];this.elements[e].domElement.getAttribute("cf-error")&&(this.errorMessages=this.elements[e].domElement.getAttribute("cf-error").split("|"))}}return this.errorMessages[Math.floor(Math.random()*this.errorMessages.length)]},enumerable:!0,configurable:!0}),e.prototype.dealloc=function(){for(var t=0;t<this.elements.length;t++){var e=this.elements[t];e.dealloc()}this.elements=null,this.errorMessages=null},e.prototype.getGroupTagType=function(){return this.elements[0].type},e.prototype.setTagValueAndIsValid=function(t){var e=!1,n=this.elements[0].type;switch(n){case"radio":for(var o=[],i=!1,s=0;s<t.controlElements.length;s++){var r=t.controlElements[s],l=this.elements[this.elements.indexOf(r.referenceTag)];r.visible&&(o.push(r),l==r.referenceTag&&(l.domElement.checked=r.checked,!i&&r.checked&&(i=!0)))}if(e||1!=o.length)!e&&i&&(e=i);else{var r=o[0],l=this.elements[this.elements.indexOf(r.referenceTag)];r.checked=!0,l.domElement.checked=!0,e=!0}break;case"checkbox":e=!0;for(var s=0;s<t.controlElements.length;s++){var r=t.controlElements[s],l=this.elements[this.elements.indexOf(r.referenceTag)];l.domElement.checked=r.checked}}return e},e}();t.TagGroup=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return"text"==n.type||"email"==n.type||"tel"==n.type||"checkbox"==n.type||"radio"==n.type||"password"==n.type||"file"==n.type,n}return __extends(e,t),e.prototype.findAndSetQuestions=function(){t.prototype.findAndSetQuestions.call(this)},e.prototype.findAndSetLabel=function(){t.prototype.findAndSetLabel.call(this),!this._label},e.prototype.setTagValueAndIsValid=function(e){return"checkbox"==this.type||t.prototype.setTagValueAndIsValid.call(this,e)},e.prototype.dealloc=function(){t.prototype.dealloc.call(this)},e}(t.Tag);t.InputTag=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){var e=function(e){function n(n){var o=e.call(this,n)||this;o.optionTags=[];for(var i=o.domElement.getElementsByTagName("option"),s=0;s<i.length;s++){var r=i[s],l=t.Tag.createTag(r);l&&o.optionTags.push(l)}return o}return __extends(n,e),Object.defineProperty(n.prototype,"type",{get:function(){return"select"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"multipleChoice",{get:function(){return this.domElement.hasAttribute("multiple")},enumerable:!0,configurable:!0}),n.prototype.setTagValueAndIsValid=function(t){for(var e=!1,n=[],o=0;o<this.optionTags.length;o++)for(var i=this.optionTags[o],s=0;s<t.controlElements.length;s++){var r=t.controlElements[s];r.referenceTag==i&&(i.selected=r.selected,!e&&i.selected&&(e=!0),r.visible&&n.push(r))}if(!e&&1==n.length){var l=n[0],i=this.optionTags[this.optionTags.indexOf(l.referenceTag)];l.selected=!0,i.selected=!0,e=!0}return e},n}(t.Tag);t.SelectTag=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return"submit"==n.domElement.getAttribute("type")||"button"==n.domElement.getAttribute("type"),n}return __extends(e,t),e}(t.Tag);t.ButtonTag=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){var e=function(e){function n(){return e.apply(this,arguments)||this}return __extends(n,e),Object.defineProperty(n.prototype,"type",{get:function(){return"option"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"label",{get:function(){return t.Helpers.getInnerTextOfElement(this.domElement)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this.domElement.selected},set:function(t){t?this.domElement.setAttribute("selected","selected"):this.domElement.removeAttribute("selected")},enumerable:!0,configurable:!0}),n.prototype.setTagValueAndIsValid=function(t){var e=!0;return e},n}(t.Tag);t.OptionTag=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return n.clickCallback=n.onClick.bind(n),n.el.addEventListener("click",n.clickCallback,!1),n.mouseDownCallback=n.onMouseDown.bind(n),n.el.addEventListener("mousedown",n.mouseDownCallback,!1),n}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"Button"},enumerable:!0,configurable:!0}),e.prototype.onMouseDown=function(t){t.preventDefault()},e.prototype.onClick=function(t){this.onChoose()},e.prototype.dealloc=function(){this.el.removeEventListener("click",this.clickCallback,!1),this.clickCallback=null,this.el.removeEventListener("mousedown",this.mouseDownCallback,!1),this.mouseDownCallback=null,t.prototype.dealloc.call(this)},e.prototype.getTemplate=function(){return'<cf-button class="cf-button">\n\t\t\t\t'+this.referenceTag.label+"\n\t\t\t</cf-button>\n\t\t\t"},e}(t.ControlElement);t.Button=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"RadioButton"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"checked",{get:function(){var t=this.el.hasAttribute("checked")&&"checked"==this.el.getAttribute("checked");return t},set:function(t){t?this.el.setAttribute("checked","checked"):this.el.removeAttribute("checked")},enumerable:!0,configurable:!0}),e.prototype.onClick=function(e){this.checked=!this.checked,t.prototype.onClick.call(this,e)},e.prototype.getTemplate=function(){var t="1"==this.referenceTag.value||this.referenceTag.domElement.hasAttribute("checked");return'<cf-radio-button class="cf-button" checked='+(t?"checked":"")+">\n\t\t\t\t<cf-radio></cf-radio>\n\t\t\t\t"+this.referenceTag.label+"\n\t\t\t</cf-radio-button>\n\t\t\t"},e}(t.Button);t.RadioButton=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"CheckboxButton"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"checked",{get:function(){return"checked"==this.el.getAttribute("checked")},set:function(t){t?this.el.setAttribute("checked","checked"):this.el.removeAttribute("checked")},enumerable:!0,configurable:!0}),e.prototype.onClick=function(t){this.checked=!this.checked},e.prototype.getTemplate=function(){var t="1"==this.referenceTag.value||this.referenceTag.domElement.hasAttribute("checked");return'<cf-button class="cf-button cf-checkbox-button '+(0==this.referenceTag.label.trim().length?"no-text":"")+'" checked='+(t?"checked":"")+">\n\t\t\t\t<cf-checkbox></cf-checkbox>\n\t\t\t\t"+this.referenceTag.label+"\n\t\t\t</cf-button>\n\t\t\t"},e}(t.Button);t.CheckboxButton=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){t.OptionButtonEvents={CLICK:"cf-option-button-click"};var e=function(e){function n(){var t=e.apply(this,arguments)||this;return t.isMultiChoice=!1,t}return __extends(n,e),Object.defineProperty(n.prototype,"type",{get:function(){return"OptionButton"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this.el.hasAttribute("selected")},set:function(t){t?this.el.setAttribute("selected","selected"):this.el.removeAttribute("selected")},enumerable:!0,configurable:!0}),n.prototype.setData=function(t){this.isMultiChoice=t.isMultiChoice,e.prototype.setData.call(this,t)},n.prototype.onClick=function(e){t.ConversationalForm.illustrateFlow(this,"dispatch",t.OptionButtonEvents.CLICK,this),document.dispatchEvent(new CustomEvent(t.OptionButtonEvents.CLICK,{detail:this}))},n.prototype.getTemplate=function(){var t='<cf-button class="cf-button '+(this.isMultiChoice?"cf-checkbox-button":"")+'" '+(this.referenceTag.domElement.selected?"selected='selected'":"")+">";return this.isMultiChoice&&(t+="<cf-checkbox></cf-checkbox>"),t+=this.referenceTag.label,t+="</cf-button>"},n}(t.Button);t.OptionButton=e}(cf||(cf={}));var cf;!function(t){var e=function(){function e(e){this.context=e.context,this.referenceTag=e.referenceTag,this.multiChoice=this.referenceTag.domElement.hasAttribute("multiple"),this.onOptionButtonClickCallback=this.onOptionButtonClick.bind(this),document.addEventListener(t.OptionButtonEvents.CLICK,this.onOptionButtonClickCallback,!1),this.createElements()}return Object.defineProperty(e.prototype,"type",{get:function(){return"OptionsList"},enumerable:!0,configurable:!0}),e.prototype.getValue=function(){for(var t=[],e=0;e<this.elements.length;e++){var n=this.elements[e];if(!this.multiChoice&&n.selected)return t.push(n),t;this.multiChoice&&n.selected&&t.push(n)}return t},e.prototype.onOptionButtonClick=function(e){if(this.multiChoice)e.detail.selected=!e.detail.selected;else{for(var n=0;n<this.elements.length;n++){var o=this.elements[n];o!=e.detail?o.selected=!1:o.selected=!0}t.ConversationalForm.illustrateFlow(this,"dispatch",t.ControlElementEvents.SUBMIT_VALUE,this.referenceTag),document.dispatchEvent(new CustomEvent(t.ControlElementEvents.SUBMIT_VALUE,{detail:e.detail}))}},e.prototype.createElements=function(){this.elements=[];for(var e=this.referenceTag.optionTags,n=0;n<e.length;n++){var o=e[n],i=new t.OptionButton({referenceTag:o,isMultiChoice:this.referenceTag.multipleChoice});this.elements.push(i),this.context.appendChild(i.el)}},e.prototype.dealloc=function(){for(document.removeEventListener(t.OptionButtonEvents.CLICK,this.onOptionButtonClickCallback,!1),this.onOptionButtonClickCallback=null;this.elements.length>0;)this.elements.pop().dealloc();this.elements=null},e}();t.OptionsList=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){var e=function(e){function n(n){var o=e.call(this,n)||this;if(o.maxFileSize=1e11,o.loading=!1,o.submitTimer=0,o.fileName="",!t.Helpers.caniuse.fileReader())throw new Error("Conversational Form Error: No FileReader available for client.");var i=o.referenceTag.domElement.getAttribute("cf-max-size")||o.referenceTag.domElement.getAttribute("max-size");if(i){var s=parseInt(i,10);o.maxFileSize=s}return o.progressBar=o.el.getElementsByTagName("cf-upload-file-progress-bar")[0],o.onDomElementChangeCallback=o.onDomElementChange.bind(o),o.referenceTag.domElement.addEventListener("change",o.onDomElementChangeCallback,!1),o}return __extends(n,e),Object.defineProperty(n.prototype,"value",{get:function(){return this.fileName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return"UploadFileUI"},enumerable:!0,configurable:!0}),n.prototype.onDomElementChange=function(e){var n=this,o=new FileReader;o.onerror=function(t){console.log("onerror",t)},o.onprogress=function(t){console.log("onprogress",t),n.progressBar.style.width=t.loaded/t.total*100+"%"},o.onabort=function(t){console.log("onabort",t)},o.onloadstart=function(e){var i=n.referenceTag.domElement.files[0],s=i?i.size:n.maxFileSize+1;if(s>n.maxFileSize){o.abort();var r={errorText:t.Dictionary.get("input-placeholder-file-size-error")};t.ConversationalForm.illustrateFlow(n,"dispatch",t.FlowEvents.USER_INPUT_INVALID,r),document.dispatchEvent(new CustomEvent(t.FlowEvents.USER_INPUT_INVALID,{detail:r}))}else{n.fileName=i.name,n.loading=!0,n.animateIn();var l=Math.floor(Math.log(s)/Math.log(1024)),a=["b","kb","mb","gb"];l=Math.min(a.length-1,l);var c=1*Number((s/Math.pow(1024,l)).toFixed(2))+" "+a[l],u=i.name+" ("+c+")";n.el.getElementsByTagName("cf-upload-file-text")[0].innerHTML=u,document.dispatchEvent(new CustomEvent(t.ControlElementEvents.PROGRESS_CHANGE,{detail:t.ControlElementProgressStates.BUSY}))}},o.onload=function(e){n.progressBar.classList.add("loaded"),n.submitTimer=setTimeout(function(){document.dispatchEvent(new CustomEvent(t.ControlElementEvents.PROGRESS_CHANGE,{detail:t.ControlElementProgressStates.READY})),n.el.classList.remove("animate-in"),n.onChoose()},2e3)},o.readAsBinaryString(e.target.files[0])},n.prototype.animateIn=function(){this.loading&&e.prototype.animateIn.call(this)},n.prototype.onClick=function(t){},n.prototype.triggerFileSelect=function(){this.referenceTag.domElement.click()},n.prototype.dealloc=function(){clearTimeout(this.submitTimer),this.progressBar=null,this.onDomElementChangeCallback&&(this.referenceTag.domElement.removeEventListener("change",this.onDomElementChangeCallback,!1),this.onDomElementChangeCallback=null),e.prototype.dealloc.call(this)},n.prototype.getTemplate=function(){"1"==this.referenceTag.value||this.referenceTag.domElement.hasAttribute("checked");return"<cf-upload-file-ui>\n\t\t\t\t<cf-upload-file-text></cf-upload-file-text>\n\t\t\t\t<cf-upload-file-progress>\n\t\t\t\t\t<cf-upload-file-progress-bar></cf-upload-file-progress-bar>\n\t\t\t\t</cf-upload-file-progress>\n\t\t\t</cf-upload-file-ui>\n\t\t\t"},n}(t.Button);t.UploadFileUI=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){t.UserInputEvents={SUBMIT:"cf-input-user-input-submit",KEY_CHANGE:"cf-input-key-change",CONTROL_ELEMENTS_ADDED:"cf-input-control-elements-added"};var e=function(e){function n(n){var o=e.call(this,n)||this;return o.errorTimer=0,o.shiftIsDown=!1,o._disabled=!1,o.el.setAttribute("placeholder",t.Dictionary.get("input-placeholder")),o.inputElement=o.el.getElementsByTagName("input")[0],o.onInputFocusCallback=o.onInputFocus.bind(o),o.inputElement.addEventListener("focus",o.onInputFocusCallback,!1),o.controlElements=new t.ControlElements({el:o.el.getElementsByTagName("cf-input-control-elements")[0]}),o.windowFocusCallback=o.windowFocus.bind(o),window.addEventListener("focus",o.windowFocusCallback,!1),o.keyUpCallback=o.onKeyUp.bind(o),document.addEventListener("keyup",o.keyUpCallback,!1),o.keyDownCallback=o.onKeyDown.bind(o),document.addEventListener("keydown",o.keyDownCallback,!1),o.flowUpdateCallback=o.onFlowUpdate.bind(o),document.addEventListener(t.FlowEvents.FLOW_UPDATE,o.flowUpdateCallback,!1),o.inputInvalidCallback=o.inputInvalid.bind(o),document.addEventListener(t.FlowEvents.USER_INPUT_INVALID,o.inputInvalidCallback,!1),o.onControlElementSubmitCallback=o.onControlElementSubmit.bind(o),document.addEventListener(t.ControlElementEvents.SUBMIT_VALUE,o.onControlElementSubmitCallback,!1),o.onControlElementProgressChangeCallback=o.onControlElementProgressChange.bind(o),document.addEventListener(t.ControlElementEvents.PROGRESS_CHANGE,o.onControlElementProgressChangeCallback,!1),o.submitButton=o.el.getElementsByTagName("cf-input-button")[0],o.onSubmitButtonClickCallback=o.onSubmitButtonClick.bind(o),o.submitButton.addEventListener("click",o.onSubmitButtonClickCallback,!1),o}return __extends(n,e),Object.defineProperty(n.prototype,"active",{get:function(){return this.inputElement===document.activeElement},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"disabled",{set:function(t){var e=this._disabled!=t;e&&(this._disabled=t,t?(this.el.setAttribute("disabled","disabled"),this.inputElement.blur()):(this.setFocusOnInput(),this.el.removeAttribute("disabled")))},enumerable:!0,configurable:!0}),n.prototype.getInputValue=function(){return this.inputElement.value},n.prototype.getFlowDTO=function(){var t;return t=this.controlElements&&this.controlElements.active?this.controlElements.getDTO():{text:this.getInputValue()},t.input=this,t},n.prototype.inputInvalid=function(e){var o=this;t.ConversationalForm.illustrateFlow(this,"receive",e.type,e.detail);var i=e.detail;this.inputElement.setAttribute("data-value",this.inputElement.value),this.inputElement.value="",this.el.setAttribute("error",""),this.disabled=!0,this.inputElement.setAttribute("placeholder",i.errorText||this.currentTag.errorMessage),clearTimeout(this.errorTimer),this.errorTimer=setTimeout(function(){o.disabled=!1,o.el.removeAttribute("error"),o.inputElement.value=o.inputElement.getAttribute("data-value"),o.inputElement.setAttribute("data-value",""),o.inputElement.setAttribute("placeholder",t.Dictionary.get("input-placeholder")),o.setFocusOnInput()},n.ERROR_TIME)},n.prototype.onFlowUpdate=function(e){var o=this;t.ConversationalForm.illustrateFlow(this,"receive",e.type,e.detail),this.el.classList.contains("animate-in")||this.el.classList.add("animate-in"),this.currentTag=e.detail,this.el.setAttribute("tag-type",this.currentTag.type),clearTimeout(this.errorTimer),this.el.removeAttribute("error"),this.inputElement.setAttribute("data-value",""),this.inputElement.value="",this.inputElement.setAttribute("placeholder",t.Dictionary.get("input-placeholder")),this.resetValue(),n.preventAutoFocus||this.setFocusOnInput(),this.controlElements.reset(),"group"==this.currentTag.type?this.buildControlElements(this.currentTag.elements):this.buildControlElements([this.currentTag]),setTimeout(function(){o.disabled=!1},1e3)},n.prototype.onControlElementProgressChange=function(e){var n=e.detail;this.disabled=n==t.ControlElementProgressStates.BUSY},n.prototype.buildControlElements=function(t){this.controlElements.buildTags(t)},n.prototype.onControlElementSubmit=function(e){t.ConversationalForm.illustrateFlow(this,"receive",e.type,e.detail);var n=e.detail;this.controlElements.updateStateOnElements(n),this.doSubmit()},n.prototype.onSubmitButtonClick=function(t){this.onEnterOrSubmitButtonSubmit()},n.prototype.onKeyDown=function(e){e.keyCode==t.Dictionary.keyCodes.shift&&(this.shiftIsDown=!0)},n.prototype.onKeyUp=function(e){if(e.keyCode==t.Dictionary.keyCodes.shift)this.shiftIsDown=!1;else if(e.keyCode==t.Dictionary.keyCodes.up)e.preventDefault(),this.active&&!this.controlElements.focus&&this.controlElements.focusFrom("bottom");else if(e.keyCode==t.Dictionary.keyCodes.down)e.preventDefault(),this.active&&!this.controlElements.focus&&this.controlElements.focusFrom("top");else if(e.keyCode==t.Dictionary.keyCodes.tab){for(var n=!1,o=e.target.parentNode;null!=o;){if(o===window.ConversationalForm.el){n=!0;break}o=o.parentNode}n||(e.preventDefault(),this.shiftIsDown&&this.controlElements.active?this.controlElements.setFocusOnElement(this.controlElements.length-1):this.setFocusOnInput())}if(!this.el.hasAttribute("disabled")){var i=this.getFlowDTO();if(e.keyCode==t.Dictionary.keyCodes.enter||e.keyCode==t.Dictionary.keyCodes.space)if(e.keyCode==t.Dictionary.keyCodes.enter&&this.active)e.preventDefault(),this.onEnterOrSubmitButtonSubmit();else if(e.keyCode==t.Dictionary.keyCodes.enter||e.keyCode==t.Dictionary.keyCodes.space){e.preventDefault();var s="group"==this.currentTag.type?this.currentTag.getGroupTagType():this.currentTag.type;if("select"==s||"checkbox"==s){var r=this.currentTag;"checkbox"==s||r.multipleChoice?this.active&&e.keyCode==t.Dictionary.keyCodes.enter?this.submitButton.click():(this.dispatchKeyChange(i,e.keyCode),this.active||(this.resetValue(),this.setFocusOnInput(),this.dispatchKeyChange(i,e.keyCode))):this.dispatchKeyChange(i,e.keyCode)}else"group"==this.currentTag.type&&this.dispatchKeyChange(i,e.keyCode)}else e.keyCode==t.Dictionary.keyCodes.space&&document.activeElement&&this.dispatchKeyChange(i,e.keyCode);else e.keyCode!=t.Dictionary.keyCodes.shift&&e.keyCode!=t.Dictionary.keyCodes.tab&&this.dispatchKeyChange(i,e.keyCode)}},n.prototype.dispatchKeyChange=function(e,n){t.ConversationalForm.illustrateFlow(this,"dispatch",t.UserInputEvents.KEY_CHANGE,e),document.dispatchEvent(new CustomEvent(t.UserInputEvents.KEY_CHANGE,{detail:{dto:e,keyCode:n,inputFieldActive:this.active}}))},n.prototype.windowFocus=function(t){n.preventAutoFocus||this.setFocusOnInput()},n.prototype.onInputFocus=function(t){this.controlElements.active&&this.controlElements.setFocusOnElement(-1)},n.prototype.setFocusOnInput=function(){this.inputElement.focus()},n.prototype.onEnterOrSubmitButtonSubmit=function(){"file"==this.currentTag.type?this.controlElements.getElement(0).triggerFileSelect():this.doSubmit()},n.prototype.doSubmit=function(){var e=this.getFlowDTO();this.disabled=!0,this.el.removeAttribute("error"),this.inputElement.setAttribute("data-value",""),t.ConversationalForm.illustrateFlow(this,"dispatch",t.UserInputEvents.SUBMIT,e),document.dispatchEvent(new CustomEvent(t.UserInputEvents.SUBMIT,{detail:e}))},n.prototype.resetValue=function(){this.inputElement.value=""},n.prototype.dealloc=function(){this.inputElement.removeEventListener("focus",this.onInputFocusCallback,!1),this.onInputFocusCallback=null,window.removeEventListener("focus",this.windowFocusCallback,!1),this.windowFocusCallback=null,document.removeEventListener("keydown",this.keyDownCallback,!1),this.keyDownCallback=null,document.removeEventListener("keyup",this.keyUpCallback,!1),this.keyUpCallback=null,document.removeEventListener(t.FlowEvents.FLOW_UPDATE,this.flowUpdateCallback,!1),this.flowUpdateCallback=null,document.removeEventListener(t.FlowEvents.USER_INPUT_INVALID,this.inputInvalidCallback,!1),this.inputInvalidCallback=null,document.removeEventListener(t.ControlElementEvents.SUBMIT_VALUE,this.onControlElementSubmitCallback,!1),this.onControlElementSubmitCallback=null,this.submitButton=this.el.getElementsByClassName("cf-input-button")[0],this.submitButton.removeEventListener("click",this.onSubmitButtonClickCallback,!1),this.onSubmitButtonClickCallback=null,e.prototype.dealloc.call(this)},n.prototype.getTemplate=function(){return'<cf-input>\n\t\t\t\t<cf-input-control-elements>\n\t\t\t\t\t<cf-list-button direction="prev">\n\t\t\t\t\t</cf-list-button>\n\t\t\t\t\t<cf-list-button direction="next">\n\t\t\t\t\t</cf-list-button>\n\t\t\t\t\t<cf-list>\n\t\t\t\t\t\t<cf-info></cf-info>\n\t\t\t\t\t</cf-list>\n\t\t\t\t</cf-input-control-elements>\n\n\t\t\t\t<cf-input-button class="cf-input-button">\n\t\t\t\t\t<svg class="cf-icon-progress" viewBox="0 0 24 22" version="1.1" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill="#B9BCBE"><polygon transform="translate(12.257339, 11.185170) rotate(90.000000) translate(-12.257339, -11.185170) " points="10.2587994 9.89879989 14.2722074 5.85954869 12.4181046 3.92783101 5.07216899 11.1851701 12.4181046 18.4425091 14.2722074 16.5601737 10.2587994 12.5405503 19.4425091 12.5405503 19.4425091 9.89879989"></polygon></g></g></svg>\n\n\t\t\t\t\t<svg class="cf-icon-attachment" viewBox="0 0 24 22" version="1.1" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink"><g><g transform="translate(-1226.000000, -1427.000000)"><g transform="translate(738.000000, 960.000000)"><g transform="translate(6.000000, 458.000000)"><path stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" d="M499,23.1092437 L499,18.907563 C499,16.2016807 496.756849,14 494,14 C491.243151,14 489,16.2016807 489,18.907563 L489,24.5042017 C489,26.4369748 490.592466,28 492.561644,28 C494.530822,28 496.123288,26.4369748 496.123288,24.5042017 L496.123288,18.907563 C496.140411,17.7478992 495.181507,16.8067227 494,16.8067227 C492.818493,16.8067227 491.859589,17.7478992 491.859589,18.907563 L491.859589,23.1092437" id="Icon"></path></g></g></g></g></svg>\n\t\t\t\t</cf-input-button>\n\t\t\t\t\n\t\t\t\t<input type=\'input\' tabindex="1">\n\n\t\t\t</cf-input>\n\t\t\t'},n}(t.BasicElement);e.preventAutoFocus=!1,e.ERROR_TIME=2e3,t.UserInput=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){t.ChatResponseEvents={AI_QUESTION_ASKED:"cf-on-ai-asked-question"};var e=function(e){function n(t){var n=e.call(this,t)||this;return n.tag=t.tag,n}return __extends(n,e),Object.defineProperty(n.prototype,"visible",{set:function(t){t?this.el.classList.add("show"):this.el.classList.remove("show")},enumerable:!0,configurable:!0}),n.prototype.setValue=function(e){void 0===e&&(e=null),this.response=e?e.text:"",this.processResponse();var n=this.el.getElementsByTagName("text")[0];if(this.response&&0!=this.response.length){if(n.innerHTML=this.response,n.setAttribute("value-added",""),
n.removeAttribute("thinking"),e.controlElements&&e.controlElements[0])switch(e.controlElements[0].type){case"UploadFileUI":n.classList.add("file-icon");var o=document.createElement("span");o.innerHTML=t.Dictionary.get("icon-type-file"),n.insertBefore(o.children[0],n.firstChild)}this.visible||(this.visible=!0),this.isAIReponse&&(t.ConversationalForm.illustrateFlow(this,"dispatch",t.ChatResponseEvents.AI_QUESTION_ASKED,this.response),document.dispatchEvent(new CustomEvent(t.ChatResponseEvents.AI_QUESTION_ASKED,{detail:this})))}else n.setAttribute("thinking","")},n.prototype.processResponse=function(){if(this.response=t.Helpers.emojify(this.response),"password"==this.tag.type&&!this.isAIReponse){for(var e="",n=0;n<this.response.length;n++)e+="*";this.response=e}},n.prototype.setData=function(n){var o=this;this.image=n.image,this.response="",this.isAIReponse=n.isAIReponse,e.prototype.setData.call(this,n),setTimeout(function(){o.visible=o.isAIReponse||o.response&&o.response.length>0,o.setValue(),o.isAIReponse?setTimeout(function(){return o.setValue({text:n.response})},t.Helpers.lerp(Math.random(),500,900)):setTimeout(function(){return o.el.classList.add("peak-thumb")},1400)},0)},n.prototype.getTemplate=function(){return'<cf-chat-response>\n\t\t\t\t<thumb style="background-image: url('+this.image+')"></thumb>\n\t\t\t\t<text>'+(this.response?this.response:"<thinking><span>.</span><span>.</span><span>.</span></thinking>")+"</text>\n\t\t\t</cf-chat-response>"},n}(t.BasicElement);t.ChatResponse=e}(cf||(cf={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},cf;!function(t){var e=function(e){function n(n){var o=e.call(this,n)||this;return o.flowUpdateCallback=o.onFlowUpdate.bind(o),document.addEventListener(t.FlowEvents.FLOW_UPDATE,o.flowUpdateCallback,!1),o.userInputUpdateCallback=o.onUserInputUpdate.bind(o),document.addEventListener(t.FlowEvents.USER_INPUT_UPDATE,o.userInputUpdateCallback,!1),o.onInputKeyChangeCallback=o.onInputKeyChange.bind(o),document.addEventListener(t.UserInputEvents.KEY_CHANGE,o.onInputKeyChangeCallback,!1),o.onControlElementsAddedToUserInputCallback=o.onControlElementsAddedToUserInput.bind(o),document.addEventListener(t.UserInputEvents.CONTROL_ELEMENTS_ADDED,o.onControlElementsAddedToUserInputCallback,!1),o}return __extends(n,e),n.prototype.onControlElementsAddedToUserInput=function(t){var e=t.detail,n=30;this.el.style.paddingBottom=e.height+n+"px"},n.prototype.onInputKeyChange=function(e){var n=e.detail.dto;if(t.ConversationalForm.illustrateFlow(this,"receive",e.type,n),this.currentResponse){var o=n.text||n.input.getInputValue();o&&0!=o.length?this.currentResponse.visible||(this.currentResponse.visible=!0):this.currentResponse.visible=!1}},n.prototype.onUserInputUpdate=function(e){if(t.ConversationalForm.illustrateFlow(this,"receive",e.type,e.detail),!this.currentResponse)throw new Error("No current response ..?");var n=e.detail;this.flowDTOFromUserInputUpdate=n},n.prototype.onFlowUpdate=function(e){t.ConversationalForm.illustrateFlow(this,"receive",e.type,e.detail);var n=e.detail;this.flowDTOFromUserInputUpdate&&(this.flowDTOFromUserInputUpdate.text||(this.flowDTOFromUserInputUpdate.text=t.Dictionary.get("user-reponse-missing")),this.currentResponse.setValue(this.flowDTOFromUserInputUpdate));var o=t.Dictionary.getAIResponse("thumb"),i="";i=n.question,this.flowDTOFromUserInputUpdate&&(i=i.split("{previous-answer}").join(this.flowDTOFromUserInputUpdate.text)),this.createResponse(!0,n,i,o),this.createResponse(!1,n)},n.prototype.createResponse=function(e,n,o,i){void 0===o&&(o=null),void 0===i&&(i=t.Dictionary.get("user-image")),this.currentResponse=new t.ChatResponse({tag:n,isAIReponse:e,response:o,image:i}),this.el.appendChild(this.currentResponse.el)},n.prototype.getTemplate=function(){return"<cf-chat type='pluto'>\n\t\t\t\t\t</cf-chat>"},n.prototype.dealloc=function(){document.removeEventListener(t.FlowEvents.FLOW_UPDATE,this.flowUpdateCallback,!1),this.flowUpdateCallback=null,document.removeEventListener(t.FlowEvents.USER_INPUT_UPDATE,this.userInputUpdateCallback,!1),this.userInputUpdateCallback=null,document.removeEventListener(t.UserInputEvents.KEY_CHANGE,this.onInputKeyChangeCallback,!1),this.onInputKeyChangeCallback=null,document.removeEventListener(t.UserInputEvents.CONTROL_ELEMENTS_ADDED,this.onControlElementsAddedToUserInputCallback,!1),this.onControlElementsAddedToUserInputCallback=null,e.prototype.dealloc.call(this)},n}(t.BasicElement);t.ChatList=e}(cf||(cf={}));var cf;!function(t){t.FlowEvents={USER_INPUT_UPDATE:"cf-flow-user-input-update",USER_INPUT_INVALID:"cf-flow-user-input-invalid",FLOW_UPDATE:"cf-flow-update"};var e=function(){function e(e){this.maxSteps=0,this.step=0,this.stepTimer=0,this.cuiReference=e.cuiReference,this.tags=e.tags,this.maxSteps=this.tags.length,this.userInputSubmitCallback=this.userInputSubmit.bind(this),document.addEventListener(t.UserInputEvents.SUBMIT,this.userInputSubmitCallback,!1)}return Object.defineProperty(e.prototype,"currentTag",{get:function(){return this.tags[this.step]},enumerable:!0,configurable:!0}),e.prototype.userInputSubmit=function(e){var n=this;t.ConversationalForm.illustrateFlow(this,"receive",e.type,e.detail);var o=e.detail;this.currentTag.setTagValueAndIsValid(o)?(t.ConversationalForm.illustrateFlow(this,"dispatch",t.FlowEvents.USER_INPUT_UPDATE,o),o=o.input.getFlowDTO(),document.dispatchEvent(new CustomEvent(t.FlowEvents.USER_INPUT_UPDATE,{detail:o})),setTimeout(function(){return n.nextStep()},250)):(t.ConversationalForm.illustrateFlow(this,"dispatch",t.FlowEvents.USER_INPUT_INVALID,o),document.dispatchEvent(new CustomEvent(t.FlowEvents.USER_INPUT_INVALID,{detail:o})))},e.prototype.start=function(){this.validateStepAndUpdate()},e.prototype.nextStep=function(){this.step++,this.validateStepAndUpdate()},e.prototype.previousStep=function(){this.step--,this.validateStepAndUpdate()},e.prototype.addStep=function(){},e.prototype.dealloc=function(){document.removeEventListener(t.UserInputEvents.SUBMIT,this.userInputSubmitCallback,!1),this.userInputSubmitCallback=null},e.prototype.validateStepAndUpdate=function(){this.step==this.maxSteps?this.cuiReference.doSubmitForm():(this.step%=this.maxSteps,this.showStep())},e.prototype.showStep=function(){t.ConversationalForm.illustrateFlow(this,"dispatch",t.FlowEvents.FLOW_UPDATE,this.currentTag),document.dispatchEvent(new CustomEvent(t.FlowEvents.FLOW_UPDATE,{detail:this.currentTag}))},e}();e.STEP_TIME=1e3,t.FlowManager=e}(cf||(cf={}));